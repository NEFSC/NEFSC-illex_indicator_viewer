---
title: "Weekly Indicators"
subtitle: "Fishing season 2022"
output:
 html_document:
    code_fold: hide
    toc: true
    toc_depth: 3
    toc_float: true
    number_sections: false
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      message = FALSE, 
                      warning = FALSE,
                      knitr.duplicate.label = "allow")
#knitr::opts_chunk$set(dev="png", options(knitr.duplicate.label = "allow"))

library(rgdal)
library(raster)
library(ggplot2)
library(cowplot)
library(patchwork)
library(flexdashboard)
library(here)
library(vembedr) # maybe use this if ember does not work 
library(embedr) # this is for embed_video
#,fig.path = "/images/" )
# knitr::opts_knit$set(base.dir = 'C:/Users/sarah.salois/Desktop/github/khyde/SquidSquad/',
#                    base.url = "/")
# knitr::include_graphics(paste0(getwd(), "/images/ft_locs_depth-with_bathy.png"))

```

```{r, eval = FALSE}

# define paths
#base.dir <- 'https://github.com/khyde/SquidSquad.git'
base.dir <- 'C:/Users/sarah.salois/Desktop/github/khyde/SquidSquad/'
base.url <- '/'
fig.path <- 'images/'

# this is where figures will be sent
paste0(base.dir, fig.path)

# this is where markdown will point for figures
paste0(base.url, fig.path)


#knitr::include_graphics('C:/Users/sarah.salois/Documents/github/khyde/SquidSquad/images/SquidSquadV1.png')
# p5 <- ggdraw() + draw_image('C:/Users/sarah.salois/Documents/github/khyde/SquidSquad/images/SquidSquadV1.png', scale = 0.5)
# plot_grid(p5)


# <div style="display: flex;">

```

![](/Users/sarah.salois/Documents/github/khyde/SquidSquad/images/SquidSquadV1.png){width=20%}

***

> Weekly updates for oceanographic indicators for the Northern Shortfin Squid, 
*Illex illecebrosus*.

***
This page is aimed to provide near-real-time observations of relevant 
oceanographic conditions in the Northwest Atlantic to aid in our understanding 
of the patterns of availability of *Illex*. This page will be updated weekly 
and weekly observations will be retained and accessible via the table of 
contents in the upper left hand corner of this page. 
***



# May
***

> Oceanographic conditions for the month of May 2022 

The plots below contain mapped images of Sea Surface Temperature (SST) and
Chlorophyll A (CHL) and the associated frontal dynamics for both. Additionally, 
you will find the Jenifer Clark charts for this week. 

## Week 22 (May 29 - June 4)
***

### Oceanographic indicators
***
SST and SST anomaly
```{r, fig.show="hold", out.width="50%"}
par(mar = c(4, 4, .1, .1))

rundate <- '202222'

knitr::include_graphics(here::here(paste0("images/sst/W_", rundate, "-MUR-V04.1-NES-SST-STATS.png")))
                        
knitr::include_graphics(here::here(paste0("images/sst/W_", rundate, "-WEEK_22_2002_2021-MUR-V04.1-NES-SST-ANOM.png")))
                        
```

CHL and CHL anomaly
```{r, fig.show="hold", out.width="50%"}
par(mar = c(4, 4, .1, .1))

rundate <- '202222'

knitr::include_graphics(here::here(paste0("images/chl/W_", rundate, "-GLOBCOLOUR-R2019-NES-CHLOR_A-GSM-STATS.png")))
                        
knitr::include_graphics(here::here(paste0("images/chl/W_", rundate, "-WEEK_22_1998_2021-GLOBCOLOUR-R2019-NES-CHLOR_A-GSM-ANOM.png")))
                        
```
*image credit: Kim Hyde*


**2 week SST animation**

<video width="500" height="500" controls>
  <source src="/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/animations/V2022_ANIMATIONS_SST_DD_20220521_20220603-MUR-V04.1-1KM-NES-SST-FPS_3.webm" type="video/webm">
</video>

*video credit: Kim Hyde*
### Mesoscale features
***

**JCC May 30, 2022**

![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/jc_charts/jc_20220530.png)
*image credit: Jenifer Clark*

> Key observations from AG:
>
> + Significant warming all along the shelf break 
> + **Gulf Stream** is reaching **79F**
> + **Slope** is at **68-70F**
> + **Shelf** is between **62-65F** 
> + **Georges Bank** is much cooler at **48F**. 
> + A band of 55-56F water is penetrating from the Northeast in to the   slope region (**blue water**) as well.


### Weekly catch 
***

```{r, figures-catchside2, fig.show="hold", out.width="50%"}
par(mar = c(4, 4, .1, .1))

rundate <- '202222'

 knitr::include_graphics(here::here(paste0("images/study_fleet/W_", 
                                          rundate, "_SF.png")))
                        
knitr::include_graphics(here::here(paste0("images/study_fleet/W_", 
                                          rundate, "_QM.png")))
  
```
*image credit: Andy Jones, Daniel Hocking*


### Salinity 
***

![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/salinity/W_202222_SAL_OFFSHORE.png)

### Notes
***

JM - NCOM observations:  

+ Most of the surface transport seems to be from the shelf to the slope sea 
  rather than from the Gulf-Stream/Slope Sea to the Shelf
+ There has been a persistent (*weeks to month*) meander set up with 
  South- South Eastward current in the same location - along the line 
  from Rhode Island to Bermuda 

GG :

+ Incredibly rich submesoscale field over the slope right now
+ Shelf water is extending further offshore than usual between 70 and 73,5 W
+ There is a long thin shingle of Gulf Stream water North of the main core. Lots of small eddies that carry water from the shelf and from the Gulf Stream.
+ One interesting note - the big Warm Core Ring to the southeast of Georges Bank, has a shelf streamer wrapped almost entirely around it. But to the west of the shelf streamer it still seems like there is warm Gulf Stream water carried north towards the shelf.

## Week 21 (May 22 - May 28)
***

### Oceanographic indicators
***

:::: {class='fluid-row'}
::: {class='col-md-6'}

**Sea Surface Temperature**

![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/sst/W_202221-MUR-V04.1-NES-SST-STATS.png)

:::

::: {class='col-md-6'}

**SST Anomaly**
![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/sst/W_202221-WEEK_21_2003_2021-MUR-V04.1-NES-SST-ANOM.png)
:::
::::

```{r, figures-chlside, fig.show="hold", out.width="50%"}
par(mar = c(4, 4, .1, .1))

rundate <- '202221'

knitr::include_graphics(here::here(paste0("images/chl/W_", rundate, "-GLOBCOLOUR-R2019-NES-CHLOR_A-GSM-STATS.png")))
                        
knitr::include_graphics(here::here(paste0("images/chl/W_", rundate, "-WEEK_21_1998_2021-GLOBCOLOUR-R2019-NES-CHLOR_A-GSM-ANOM.png")))
                        
```
*image credit: Kim Hyde*


```{r, eval=FALSE,  out.width="100%"}
# This is too small - html is better viewing
# 2 Week SST animation w/webm in R chunk, 5 fps 
embed_video(here::here('images/animations/DD_20220507_20220520-MUR-V04.1-1KM-NES-SST-FPS_5.webm'))

```


**2 week SST animation**

<video width="500" height="500" controls>
  <source src="/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/animations/DD_20220514_20220527-MUR-V04.1-1KM-NES-SST-FPS_3.webm" type="video/webm">
</video>

*video credit: Kim Hyde*

### Mesoscale features
***

**JCC May 23, 2022**

![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/jc_charts/jc_20220523.png)
*image credit: Jenifer Clark*

### Weekly catch 
***

```{r, figures-catchside, fig.show="hold", out.width="50%"}
par(mar = c(4, 4, .1, .1))

rundate <- '202221'

knitr::include_graphics(here::here(paste0("images/study_fleet/W_", 
                                          rundate, "_SF.png")))
                        
knitr::include_graphics(here::here(paste0("images/study_fleet/W_", 
                                          rundate, "_QM.png")))
  
```

*image credit: Andy Jones, Daniel Hocking*

### Salinity
***

![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/salinity/W_202221_SAL_OFFSHORE.png)


### Notes

+ GG & AS: Shingle starting to wrap around WCR - possible squid bridge connection 
+ AM: Some boats went looking for Illex around the eddies at 65W and 72W last week,
  but didnâ€™t find much

## Week 20 (May 15 - May 21)
***

### Oceanographic indicators
***

:::: {class='fluid-row'}

::: {class='col-md-6'}

**Sea Surface Temperature**

![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/sst/W_202220-MUR-V04.1-NES-SST-STATS_WHALE.png)
:::

::: {class='col-md-6'}

**Chlorophyll**

![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/chl/W_202220-GLOBCOLOUR-R2019-NES-CHLOR_A-GSM-STATS.png)
:::
::::
*image credit: Kim Hyde*

**2 week SST animation**

<video width="500" height="500" controls>
  <source src="/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/animations/DD_20220507_20220520-MUR-V04.1-1KM-NES-SST-FPS_5.webm" type="video/webm">
</video>

*video credit: Kim Hyde*

### Mesoscale features
***

**JCC May 18, 2022**

![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/jc_charts/jc_20220518.png)


**JCC May 20, 2022**

![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/jc_charts/jc_20220520.png)
*image credit: Jenifer Clark*


### Salinity

![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/salinity/W_202220-SAL-OFFSHORE.png)

### Notes 

+ AS: May be another shingle forming, keep an eye in coming weeks 
+ Many North Atlantic Right whales located On the NE edge of Grand Banks 
(on the GOM side)
+ Whales not expected in that region
+ Oceanographic conditions that may be aggregating the whales? 
  + Increased flow at bifurcation point at Northern part of channel
  + Increased food availability here? 

+ No *Illex* present in Hudson or Norfolk canyons 


## Week 19 (May 8 - May 14)
***

### Oceanographic indicators
***
**Sea Surface Temperature**

![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/sst/W_202219-MUR-V04.1-NES-SST-STATS.png){width=55%}
*image credit: Kim Hyde*


### Mesoscale features
***
:::: {class='fluid-row'}

::: {class='col-md-6'}
**JCC May 09, 2022**
![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/jc_charts/jc_20220509.png)
:::

::: {class='col-md-6'}

**JCC May 11, 2022**
![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/jc_charts/jc_20220511.png)

:::
::::
*image credit: Jenifer Clark*

### Salinity
***
### Notes
***

+ AG: Two WCRs in our region -- both connected to the Gulf Stream with individual Squid bridges or streamers.

***

## Week 18 (May 1-7)
***

### Oceanographic indicators
***

:::: {class='fluid-row'}
::: {class='col-md-6'}

**Sea Surface Temperature**

![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/sst/W_202218-MUR-V04.1-NES-SST-STATS.png)
:::
::: {class='col-md-6'}

**Chlorophyll**

![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/chl/W_202218-GLOBCOLOUR-R2019-NES-CHLOR_A-GSM-STATS.png)
:::
::::
*image credit: Kim Hyde*

### Mesoscale features 
***

:::: {class='fluid-row'}

::: {class='col-md-6'}

**JCC May 04, 2022**

![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/jc_charts/jc_20220504.png)
:::
::: {class='col-md-6'}

**JCC May 06, 2022**

![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/jc_charts/jc_20220506.png)
:::
::::
*image credit: Jenifer Clark*


### Salinity 
***

:::: {class='fluid-row'}
::: {class='col-md-6'}
**Mean Salinity (Pioneer Array, CENTRAL)**
![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/salinity/W_202218-SAL-CENTRAL.png)
:::
::: {class='col-md-6'}
**Mean Salinity (Pioneer Array, INSHORE)**
![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/salinity/W_202218-SAL-INSHORE.png)
:::
::::

**Mean Salinity (Pioneer Array, OFFSHORE)**
![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/salinity/W_202218-SAL-OFFSHORE.png)


**YTD : Mean Salinity (Pioneer Array, w/2021 reference)**
![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/salinity/A_2021-2022-SAL-CENTRAL.png)


```{r, eval=FALSE}
# Trial run : 
# This works in chunk but wont knit **
jc_weekly <- list.files(here::here('images/jc_charts'), 
                        pattern = '.png', 
                        full.names = TRUE)
knitr::include_graphics(jc_weekly)
```

```{r, eval=FALSE}
# This works in chunk but wont knit **

knitr::include_graphics(here::here(c("images/jc_charts/jc_0425.jpg", 'images/jc_charts/jc_0427.jpg')))

```

### Notes
***

# April
***

## Week 17 (April 24 - April 30)
***

### Oceanographic indicators

:::: {class='fluid-row'}
::: {class='col-md-6'}

**Sea Surface Temperature**

![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/sst/W_202217-MUR-V04.1-NES-SST-STATS.png)
:::

::: {class='col-md-6'}

**Chlorophyll**

![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/chl/W_202217-GLOBCOLOUR-R2019-NES-CHLOR_A-GSM-STATS-.png)
:::
::::
*image credit: Kim Hyde*


### Mesoscale features

:::: {class='fluid-row'}
::: {class='col-md-6'}

**JCC April 25, 2022**
![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/jc_charts/jc_20220425.png)
:::
::: {class='col-md-6'}
**JCC April 27, 2022**
![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/jc_charts/jc_20220427.png)
:::
::::
*image credit: Jenifer Clark*

### Salinity

### Notes

## Week 16 (April 17 - April 23)
***

### Oceanographic indicators

:::: {class='fluid-row'}
::: {class='col-md-6'}
**Sea Surface Temperature**

![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/sst/W_202216-MUR-V04.1-NES-SST-STATS.png)
:::

::: {class='col-md-6'}

**Chlorophyll**

![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/chl/W_202216-GLOBCOLOUR-R2019-NES-CHLOR_A-GSM-STATS-.png)
:::
::::
*image credit: Kim Hyde*

### Mesoscale features

### Salinity

### Notes


## Week 15 (April 10 - April 16)
***

### Oceanographic indicators


### Mesoscale features

:::: {class='fluid-row'}
::: {class='col-md-6'}
**JCC April 11, 2022**
![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/jc_charts/jc_20220411.png)
:::
::: {class='col-md-6'}

**JCC April 13, 2022**
![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/jc_charts/jc_20220413.png)
:::
::::
*image credit: Jenifer Clark*


### Salinity

### Notes
AG: Things are heating up with really warm GS water closing in on the shelf 
break near 67W! 

+ 4/11: As Adrienne predicted last week, there might be a ring forming 
near 67W! And look at the temperature difference between the ring water (72F) 
and the shelf water (48F) next to each other!

+ 4/13: The Gulf Stream has a mind of its own! Look at the huge trough near
 69-70W now!
 
GG: Some remarkable processes revealed in this image, including a possible 
squid bridge to the shelfbreak.

AM: Lots going on out there to keep track of as we inch closer to squid season.
No signs of squid yet, other than some large ones in the bellies of tuna 
offshore

## Week 14 (April 3 - April 9)
***

### Oceanographic indicators


### Mesoscale features 
:::: {class='fluid-row'}

::: {class='col-md-6'}
**JCC April 06, 2022**
![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/jc_charts/jc_20220406.png)
:::

::: {class='col-md-6'}
**JCC April 08, 2022**
![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/jc_charts/jc_20220408.png)
:::
::::
*image credit: Jenifer Clark*

### Salinity

### Notes
AG: (4/6/22) There is one WCR on the shelf break and a large streamer along the
MAB shelf. A lot of activity to the east of the Ring-meander set up at 65W. 

+ Magdalena who just came back visiting the NESC, notes the water is warm 
out there

AG: (4/8/22) WCR forming at 62-64W and the nice shelf-streamers to just east of 
it and then down along the GS crest's leading edge. 

+ This shelf water (blue band) is also going to interact with the WCR at 
60W in the coming week!

**April Salinity Time Series (Pioneer Array, *in-situ* data)**
![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/salinity/pa_0422.png)

***
# General Information
***

## Major Canyons 
***

[Major Canyons](https://portal.midatlanticocean.org/visualize/#x=-74.00&y=39.00&z=7&logo=true&controls=true&dls%5B%5D=true&dls%5B%5D=1&dls%5B%5D=3944&basemap=ocean&themes%5Bids%5D%5B%5D=28&tab=active&legends=false&layers=true)

![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/general_info/aggCPUEplot_canyons.png)
*image credit: Brooke Lowman*

## Body weight trends across years
***

A quick look at the average body weight data from 1997 through 2019. The data
were derived via subsamples collected from landings from various Illex 
processors. Colors correspond to Paul Rago's qualitative measures of system state, where green indicates  a 'Good' year, pink an 'Average' year and blue a 'Poor' year. 


![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/general_info/wts_by_state.png)


Here we can see the spread across years by fleet. 

![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/general_info/wts_by_flt_yr.png) 



The figures below parses out the same information (mean body weight) for each 
week across individual fishing fleets. Here, Wet boats refer to vessels with 
refrigerated sea water or ice holds.


![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/general_info/W_wt_box.png)



## Fishing depths 2021 Fishing Season
***

The figure below highlights the 100 meter isobath and associated fishing depths throughout the 2021 season. 

![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/general_info/ft_locs_depth-with_bathy.png){width = 75%}
*image credit: Kim Hyde*


## NAFO subareas 
*** 

This shape file depicts a range of 20 meters inshore of the shelf break
(200m isobath)

```{r, echo == FALSE, results ='hide', message = FALSE, warning = FALSE}
library(mapdata) # dist2isobath
library(marmap)  # getNOAA.bathy
## bring in bathymetry data from marmap package
pt.baty415 <- getNOAA.bathy(lon1 = -66, lon2 = -76, 
                            lat1 = 35, lat2 = 44, 
                            resolution = 1) #41.5
## get coastline from mapdata 
reg = map_data("world2Hires")
reg = subset(reg, region %in% c('Canada', 'USA', 'Mexico'))
reg$long = (360 - reg$long)*-1 
```



```{r, nafo subareas, message = FALSE, warning = FALSE}
wd =  here::here('shapefiles/')
nafo_shbr <- readOGR(wd,'NAFO_SHELFBREAK', verbose = FALSE)
inshr <- nafo_shbr[nafo_shbr@data$SUBAREA %in% c('NAFO_5ZE_INSHORE', 'NAFO_5ZW_INSHORE','NAFO_6A_INSHORE', 'NAFO_6B_INSHORE','NAFO_6C_INSHORE'),]
```


```{r, eval = FALSE}

# This chunk will extract data across NAFO_SHELFBREAK to get mean values 
# for each subarea

# path = '/nadata/PROJECTS/IDL_PROJECTS/ILLEX_INDICATORS/R_SCRIPTS/SALINITY/RASTERS/WEEKLY'
# bricks <- list.files(path = path,
#                      pattern = glob2rx('b_ww_sal_222m*.tif'),
#                      full.names = TRUE)
# k = 13 # 2020
# btmp <- brick(bricks[k])
# btmp@data@names <- as.numeric(c(1:52))
# tmp2 <- subset(tmp, week == weeks[j])
# rtmp = raster::subset(btmp, which(btmp@data@names == weeks[j]))
# rtmp <- raster('test_inshore.tif')
# sal_222m <-  raster::extract(rtmp, inshr, weights = FALSE,
#                              fun = mean, na.rm = TRUE) 
# #sal_222m[1:5]


```



```{r}
ggplot() + 
  geom_polygon(data = reg, aes(x=long, y = lat, group = group), 
               color = "gray20", fill = "wheat3") +
  coord_sf(xlim = c(-80,-66), ylim = c(33,47)) + 
  geom_polygon(data = inshr, aes(x = long, y = lat, 
                                 group = group, fill = id), 
               color = 'black') +
  # geom_polygon(data = mjr_canyons, aes(x = long, y = lat, 
  #                                      group= group, fill = id), 
  #              color = 'black') +
  # scale_fill_discrete(name ='Canyons',
  #                     labels = c('Hudson', 'Wilmington', 'Norfolk')) +
  geom_contour(data = pt.baty415, aes(x = x, y = y, z = z), 
               breaks = c(-100,-200), colour ="gray20", size = 0.7) +
  scale_fill_discrete(name ='NAFO Subareas',  
                      labels = c('5ze', '5zw', '6a', '6b', '6c'))+
  
  ggtitle(paste0('NES Region')) + 
  theme_minimal()
```




```{r, canyons, eval = FALSE}
# wd = ('C:/Users/sarah.salois/Documents/shape_files')
# canyons <- readOGR(wd, 'major_canyons')
# # reproject data
# # Transform units from UTC (meters) to LatLon (decimal degrees)
# canyons <- spTransform(canyons, CRS('+init=epsg:4326')) # this worked once and now wont
# canyons <- spTransform(canyons,
#                       CRSobj = '+init=epsg:4326 +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0')
# crs(canyons) # check
# extent(canyons) # check
# mjr_canyons <- canyons[canyons@data$Name %in% c('Norfolk Canyon',
#                                                 'Wilmington Canyon',
#                                                 'Hudson Canyon'),]
# 
# # different trys to fix projection (longitudes are wrong, extent )
# 
# canyons.sf <- st_as_sf(canyons, crs = '+init=epsg:4326 +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0')
# extent(canyons) <- c(-74.34716, -65.91845, 33.74994,37.5575) # was -94.34716,  -85.91845
# 
# # Another try
# canyons.sf <- st_set_crs(canyons, "+proj=utm +zone=18 +ellps=GRS80 +datum=NAD83") 
# canyons.sf <- st_set_crs(canyons.sf, 
#                          '+init=epsg:4326 +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0') 
# test.sp <- canyons.sf %>% as("Spatial") # From sf to spatial
# extent(test.sp)
# 
# canyons@polygons@coords
# canyons$long = (360 - canyons$long)*-1 
# extent(canyons_WGS84)

```




```{r, echo = FALSE, messages = FALSE, eval = FALSE}
# Canyon projection wrong (see longitude) - fix and add to previous figure

ggplot() +
  geom_polygon(data = mjr_canyons, aes(x = long, y = lat, 
                                 group= group, fill = id), 
                                 color = 'black') +
  scale_fill_discrete(name ='Canyons',
                         labels = c('Hudson', 'Wilmington', 'Norfolk')) +
  theme_minimal()
```

# 2021 Case Study

> JULY 25- 31: Industry noted that squid seemed to have disappeared off the 
shelf after being present in high abundance for the last few months. 

Looking into the oceanographic conditions, team realized there was an increase
in sea surface temperature of about 5 degrees over the course of one week. 
Additionally, they noted continued westward propagation of warm ring/GS water,
hypothesized to be dispersing or redistributing the squid.

Below are some figures generated and annotated by Avijit Gangopadhyay and
Glen Gawarkiewicz

:::: {class='fluid-row'}

::: {class='col-md-6'}
**JCC: July 23 2021**
![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/jc_charts/jc_20210723.png)
:::
  
::: {class='col-md-6'}
**JCC: July 26 2021**
![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/jc_charts/jc_20210726.png)
:::
::::

:::: {class='fluid-row'}

::: {class='col-md-6'}

**JCC: August 2 2021**
![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/jc_charts/jc_20210802.png)

:::

::: {class='col-md-6'}

**JCC: August 4 2021**
![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/jc_charts/jc_20210804.png)

:::
::::
*image credit: Jenifer Clark*

Avijit noted: Temperature along the shelfbreak
(from SNE to south of Georges Bank) was about 75F on 7/23/21, increases to
about 78-80 on 7/26/21 with mostly westward flow along the shelf break 
(below Georges Bank) with another WCR covering the SNE shelf (this WCR has 
colder shelf water in its core â€“ this happened due to the WCR entraining a 
shelf streamer the previous week). Finally, the whole shelfbreak seems to be
warm with temperature at about 79-81 all along SNE and South of the
Northeast Channel.

+ There is an overall tendency of the warm GS/Ring water flowing westward and 
flooding the shelfbreak. Is this interacting or part of the shelf break jet 
itself? 

+ High temperature all along the shelf break with a train of along-shelf 
features more like a warm blob. Could it be a new marine heat wave?


**In-situ Salinity time series for the  month of July 2021 (from Pioneer Array)**
![](/Users/sarah.salois/Documents/github/ssalois1/NEFSC-illex_indicator_viewer/images/salinity/pa_0721.png)
*image credit: Glen Gawarkiewicz*

Glen noted: "About a week ago there was a big drop (nearly 1 psu) in salinity at
the inshore Pioneer Array mooring at 7 m depth. This is indicative of a big
retreat of the slope/ring water. The salinity dropped from around 34.2 to 
around 33.2 on July 27. Salinities on the outer shelf were very high during 
the Armstrong cruise the second half of June. The shelf break front was in an 
anomalously shoreward position, probably 20 NM shoreward of the usual position
during the Armstrong cruise June 18-July 2. The shelf break front also was 
anomalously onshore south of Hudson Canyon recently from Rutgers glider
transects. What is interesting over the past 2-3 months is the large number of 
rings. Ring influence on the outer shelf has been pronounced throughout the 
entire MAB. I wonder if the front popping back to its normal position has 
occurred over a large area. We will have to think about ways to test this
(altimeter?)."

+ This is really important to figure out why a pulse would end as well as why
it would begin.

Avijit's response: "We should look at altimetry. Contours and their movement as 
well as cross track velocities which will resolve the SBF better. That will tell
us a lot. We could also look at winds! And offshore changes might be captured
by the few argo floating in these rings. Their trajectories might have changed
from a ring-silo configuration to a ring-coalescence configuration." 


> AUGUST 7, 2021 : Industry reports fishing has resumed, starting in a piece of
water around Wilmington and Spencers canyon.

JM: The fishing was reportedly not as good as it was a month prior and one 
harvester reported seeing a change in size frequency of fish available during 
the last trip from larger to smaller. 










```{r echo = FALSE, results = 'asis', eval = FALSE}
# Below is a table which highlights the mean values for Bottom Temperature, 
# Salinity across the shelf break, broken up into 5 NAFO subareas of interest, 
# 5zE, 5zW, 6A, 6B, 6C



library(knitr)
kable(mtcars[1:5, ], caption = "Sub-surface features across time")
# Create a dataframe with BT, Salinity across each zone for years of interest
```


```{r, eval = FALSE}
jc_img <- system.file('jc_0425.jpg', 'jc0427.jpg', package = "cowplot")
plot_grid(
  p + theme(legend.position = c(1, 1), legend.justification = c(1, 1)),
  p2,
  labels = "AUTO"
)

p1 <- ggdraw() +
  draw_image('C:/Users/sarah.salois/Documents/github/khyde/SquidSquad/images/jc_425_v2.png', 
             scale = 0.9)
p2 <- ggdraw() + 
  draw_image('C:/Users/sarah.salois/Documents/github/khyde/SquidSquad/images/jc0427.jpg', 
             scale = 1.0)
plot_grid(p1, p2)

```



```{r, eval = FALSE}
# Would need to play around with image / grid size, not as flexible as columns
p1 <- ggdraw() + draw_image('C:/Users/sarah.salois/Documents/github/khyde/SquidSquad/images/M_201606-MUR-V04.1-NES-SST-STATS-MEAN.png', scale = 1.0)
p2 <- ggdraw() + draw_image('C:/Users/sarah.salois/Documents/github/khyde/SquidSquad/images/M_201603-OCCCI-V5.0-NES-CHLOR_A-CCI-STATS-STD.png', scale = 1.0)
p3 <- ggdraw() + draw_image('C:/Users/sarah.salois/Documents/github/khyde/SquidSquad/images/W_201638-GLORYS-NES-BOTTOM_TEMPERATURE-WCR-CHLFRONTS.png', scale = 1.0)
# p3 <- ggdraw() + draw_image('C:/Users/sarah.salois/Documents/github/khyde/SquidSquad/images/jc0425.jpg', scale = 0.9)

p4 <- ggdraw() + draw_image('C:/Users/sarah.salois/Documents/github/khyde/SquidSquad/images/jc0427.jpg', scale = 1.0)
plot_grid(p1, p2, p3, p4)
```

```{r, eval = FALSE}
# Another way to include images
# knitr::include_graphics('C:/Users/sarah.salois/Documents/github/khyde/SquidSquad/images/M_201606-MUR-V04.1-NES-SST-STATS-MEAN.png')

```